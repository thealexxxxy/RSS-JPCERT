#! ruby -Ku

require "open-uri"
require 'rexml/document'
require 'kconv'

xml = open("http://jvn.jp/rss/jvn.rdf") {|f| f.read}
    doc = REXML::Document.new(xml)

# 脆弱性関連情報

v_ary = ""

doc.elements.each('rdf:RDF')do |element|
 i = element.elements.size

n = 1
while n < i

title = doc.elements["rdf:RDF/item/title[#{n}]"].text
link = doc.elements["rdf:RDF/item/link[#{n}]"].text
id = doc.elements["rdf:RDF/item/dc:identifier[#{n}]"].text
data = doc.elements["rdf:RDF/item/dc:date[#{n}]"].text

v_ary << title + "\n"
v_ary << link + "\n"
v_ary << data + "\n"
v_ary << "\n"

 n += 1  
end
end

file_name = "jpcert_vulnerability_data.txt"

File.open(file_name,'w'){|file|
 file.write v_ary
}

